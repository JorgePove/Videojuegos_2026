<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Videojuegos 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;700&family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-overlay: rgba(13, 13, 13, 0.85);
            --panel-color: rgba(26, 26, 26, 0.9);
            --accent-color: #00ffcc;
            --text-main: #ffffff;
            --star-color: #ffcc00;
        }

        body {
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-color: #0d0d0d;
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 1200px;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-overlay);
            backdrop-filter: blur(5px) brightness(0.6);
            z-index: -1;
        }

        .title-container {
            border: 4px double #fff;
            padding: 20px 40px;
            margin-bottom: 40px;
            position: relative;
            box-shadow: 0 0 15px var(--accent-color), inset 0 0 15px var(--accent-color);
            background: rgba(0, 0, 0, 0.9);
        }

        header h1 {
            font-family: 'Press Start 2P', cursive;
            font-size: 2rem;
            text-align: center;
            margin: 0;
            animation: neonRGB 6s infinite linear;
        }

        @keyframes neonRGB {
            0% { color: #ff00ff; text-shadow: 0 0 10px #ff00ff; }
            33% { color: #00ffff; text-shadow: 0 0 10px #00ffff; }
            66% { color: #ffff00; text-shadow: 0 0 10px #ffff00; }
            100% { color: #ff00ff; text-shadow: 0 0 10px #ff00ff; }
        }

        .container {
            display: flex;
            flex-direction: row;
            gap: 20px;
            width: 100%;
            max-width: 1400px;
            justify-content: space-between;
        }

        .column {
            background: var(--panel-color);
            border: 2px solid rgba(255,255,255,0.1);
            padding: 15px;
            flex: 1;
            min-height: 600px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }

        .column h2 {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            text-align: center;
            color: var(--accent-color);
            margin-top: 0;
            padding-bottom: 15px;
            border-bottom: 1px solid #444;
            text-transform: uppercase;
        }

        .add-task {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 25px;
            position: relative;
        }

        input, select, button.add-btn {
            background: rgba(0,0,0,0.7);
            color: #fff;
            border: 1px solid #555;
            padding: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            border-radius: 4px;
        }

        .suggestions {
            position: absolute;
            top: 40px;
            left: 0;
            right: 0;
            background: #222;
            border: 1px solid var(--accent-color);
            z-index: 100;
            max-height: 250px;
            overflow-y: auto;
            display: none;
            border-radius: 4px;
        }

        .suggestion-item {
            padding: 8px;
            cursor: pointer;
            border-bottom: 1px solid #333;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .suggestion-item img {
            width: 30px;
            height: 40px;
            object-fit: cover;
            border-radius: 2px;
        }

        .suggestion-item:hover {
            background: var(--accent-color);
            color: #000;
        }

        button.add-btn {
            cursor: pointer;
            background: #222;
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
            font-family: 'Press Start 2P', cursive;
            font-size: 0.55rem;
            margin-top: 5px;
        }

        .game-item {
            background: rgba(40, 40, 40, 0.8);
            border-left: 4px solid var(--accent-color);
            padding: 10px;
            margin-bottom: 12px;
            display: flex;
            gap: 12px;
            align-items: center;
            border-radius: 0 8px 8px 0;
        }

        .game-cover {
            width: 50px;
            height: 65px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid rgba(255,255,255,0.2);
            background: #000;
        }

        .game-info { flex-grow: 1; font-family: 'Inter', sans-serif; }
        .game-title { font-size: 0.95rem; font-weight: 700; color: #fff; display: block;}
        .game-meta { font-size: 0.75rem; color: #aaa; }

        .stars-container { font-size: 1.1rem; margin-top: 3px; cursor: pointer; color: #444; }
        .star.filled { color: var(--star-color); position: relative; display: inline-block; }
        .star.half::after { content: '★'; position: absolute; left: 0; width: 50%; overflow: hidden; color: var(--star-color); }

        .actions { display: flex; gap: 8px; align-items: center; }
        .move-btn { background: none; border: 1px solid var(--accent-color); color: var(--accent-color); cursor: pointer; padding: 2px 6px; border-radius: 4px; }
        .delete-btn { color: #ff4444; background: none; border: none; font-size: 1.2rem; cursor: pointer; }
    </style>
</head>
<body>

    <div class="title-container">
        <header><h1>VIDEOJUEGOS 2026</h1></header>
    </div>

    <div class="container">
        <script>
            const colConfig = [
                { id: 'todo', label: 'POR JUGAR' },
                { id: 'playing', label: 'JUGANDO' },
                { id: 'completed', label: 'COMPLETADOS' }
            ];
            
            colConfig.forEach(col => {
                document.write(`
                    <div class="column" id="col-${col.id}">
                        <h2>${col.label}</h2>
                        <div class="add-task">
                            <input type="text" id="input-${col.id}" placeholder="Escribe para buscar..." 
                                oninput="searchGames('${col.id}')" onkeypress="handleKeyPress(event, '${col.id}')" autocomplete="off">
                            <div id="sugg-${col.id}" class="suggestions"></div>
                            <input type="hidden" id="img-${col.id}" value="">
                            <select id="platform-${col.id}"></select>
                            <select id="year-${col.id}"></select>
                            <button class="add-btn" onclick="addGame('${col.id}')">AÑADIR</button>
                        </div>
                        <ul class="game-list" id="list-${col.id}"></ul>
                    </div>
                `);
            });
        </script>
    </div>

    <script>
        // ***************************************************************
        // AQUI ABAJO -> PEGA TU API KEY DE RAWG.IO ENTRE LAS COMILLAS
        // ***************************************************************
        const API_KEY = 'a7e92d02270f400b8eb4af98af6ce7b8'; 
        // ***************************************************************

        const platforms = ["PC", "Switch", "PS5"];
        const years = Array.from({length: 2026 - 1980 + 1}, (_, i) => 2026 - i);

        function setupSelectors() {
            ['todo', 'playing', 'completed'].forEach(col => {
                const pSelect = document.getElementById(`platform-${col}`);
                const ySelect = document.getElementById(`year-${col}`);
                platforms.forEach(p => pSelect.add(new Option(p, p)));
                years.forEach(y => ySelect.add(new Option(y, y)));
            });
        }

        let timeout = null;
        async function searchGames(colId) {
            const query = document.getElementById(`input-${colId}`).value;
            const suggBox = document.getElementById(`sugg-${colId}`);
            
            clearTimeout(timeout);
            if (query.length < 3) { suggBox.style.display = 'none'; return; }

            timeout = setTimeout(async () => {
                try {
                    const response = await fetch(`https://api.rawg.io/api/games?key=${API_KEY}&search=${query}&page_size=5`);
                    const data = await response.json();
                    
                    suggBox.innerHTML = '';
                    suggBox.style.display = 'block';

                    data.results.forEach(game => {
                        const div = document.createElement('div');
                        div.className = 'suggestion-item';
                        const year = game.released ? game.released.split('-')[0] : 'N/A';
                        const img = game.background_image || '';
                        
                        div.innerHTML = `<img src="${img}" onerror="this.src='https://via.placeholder.com/30x40?text=?'"> <span>${game.name} (${year})</span>`;
                        div.onclick = () => selectGame(colId, game.name, year, game.platforms, img);
                        suggBox.appendChild(div);
                    });
                } catch (e) { console.error("Error en API"); }
            }, 500);
        }

        function selectGame(colId, name, year, gamePlatforms, img) {
            document.getElementById(`input-${colId}`).value = name;
            document.getElementById(`img-${colId}`).value = img;
            document.getElementById(`sugg-${colId}`).style.display = 'none';
            
            const ySelect = document.getElementById(`year-${colId}`);
            if ([...ySelect.options].some(o => o.value == year)) ySelect.value = year;

            const pSelect = document.getElementById(`platform-${colId}`);
            const pNames = gamePlatforms.map(p => p.platform.name.toLowerCase());
            if (pNames.some(n => n.includes('pc'))) pSelect.value = "PC";
            else if (pNames.some(n => n.includes('switch'))) pSelect.value = "Switch";
            else if (pNames.some(n => n.includes('playstation 5'))) pSelect.value = "PS5";
        }

        function handleKeyPress(e, col) { if (e.key === "Enter") addGame(col); }

        function addGame(colId, data = null) {
            const name = data ? data.name : document.getElementById(`input-${colId}`).value.trim();
            const platform = data ? data.platform : document.getElementById(`platform-${colId}`).value;
            const year = data ? data.year : document.getElementById(`year-${colId}`).value;
            const img = data ? data.img : document.getElementById(`img-${colId}`).value;
            const rating = data ? data.rating : 0;

            if (!name) return;

            const list = document.getElementById(`list-${colId}`);
            const li = document.createElement("li");
            li.className = "game-item";
            
            let moveBtn = (colId === 'todo') ? `<button class="move-btn" onclick="moveGame(this, 'playing')">→</button>` : 
                          (colId === 'playing') ? `<button class="move-btn" onclick="moveGame(this, 'completed')">→</button>` : "";

            let starsHtml = (colId === 'completed') ? `<div class="stars-container" onclick="handleStarClick(event, this)">${renderStars(rating)}</div>` : "";
            
            const coverHtml = img ? `<img src="${img}" class="game-cover">` : `<div class="game-cover" style="display:flex;align-items:center;justify-content:center;font-size:10px">N/A</div>`;

            li.innerHTML = `
                ${coverHtml}
                <div class="game-info">
                    <span class="game-title">${name.toUpperCase()}</span>
                    <span class="game-meta">${platform} • ${year}</span>
                    ${starsHtml}
                </div>
                <div class="actions">
                    ${moveBtn}
                    <button class="delete-btn" onclick="removeGame(this)">×</button>
                </div>
            `;

            list.appendChild(li);
            if (!data) {
                document.getElementById(`input-${colId}`).value = "";
                document.getElementById(`img-${colId}`).value = "";
                saveData();
            }
        }

        function renderStars(rating) {
            let html = "";
            for (let i = 1; i <= 5; i++) {
                let cls = "star";
                if (rating >= i) cls += " filled";
                else if (rating >= i - 0.5) cls += " half";
                html += `<span class="${cls}" data-value="${i}" style="position:relative; display:inline-block">★</span>`;
            }
            return html;
        }

        function handleStarClick(e, container) {
            const rect = e.target.getBoundingClientRect();
            const starValue = parseInt(e.target.dataset.value);
            if (!starValue) return;
            const finalRating = (e.clientX - rect.left < rect.width / 2) ? starValue - 0.5 : starValue;
            container.innerHTML = renderStars(finalRating);
            saveData();
        }

        function removeGame(btn) { btn.closest('.game-item').remove(); saveData(); }

        function moveGame(btn, nextColId) {
            const item = btn.closest('.game-item');
            const name = item.querySelector('.game-title').innerText;
            const meta = item.querySelector('.game-meta').innerText.split(' • ');
            const img = item.querySelector('.game-cover')?.src || "";
            addGame(nextColId, { name, platform: meta[0], year: meta[1], img });
            item.remove();
            saveData();
        }

        function saveData() {
            const gameData = {
                todo: getListData('list-todo'),
                playing: getListData('list-playing'),
                completed: getListData('list-completed')
            };
            localStorage.setItem('videojuegos2026_data', JSON.stringify(gameData));
        }

        function getListData(listId) {
            return Array.from(document.getElementById(listId).children).map(li => {
                const stars = li.querySelector('.stars-container');
                let rating = 0;
                if (stars) {
                    const filled = stars.querySelectorAll('.star.filled').length;
                    const half = stars.querySelectorAll('.star.half').length;
                    rating = filled + (half * 0.5);
                }
                return {
                    name: li.querySelector('.game-title').innerText,
                    platform: li.querySelector('.game-meta').innerText.split(' • ')[0],
                    year: li.querySelector('.game-meta').innerText.split(' • ')[1],
                    img: li.querySelector('.game-cover')?.src || "",
                    rating: rating
                };
            });
        }

        function loadData() {
            const saved = localStorage.getItem('videojuegos2026_data');
            if (saved) {
                const data = JSON.parse(saved);
                Object.keys(data).forEach(id => data[id].forEach(g => addGame(id, g)));
            }
        }

        setupSelectors();
        loadData();
    </script>
</body>
</html>
